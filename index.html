<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title></title>
  <meta name="Keywords" content="小艾,个人博客,前端特效">
  <meta name="description" content="小艾的个人博客，小艾的技术作品，小艾的IT成长之路">
  <meta name="author" content="艾华桥,Myth" />
  <meta name="renderer" content="webkit" />
  <meta name="force-rendering" content="webkit" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="img/logo.ico" type="image/x-icon" />
  <!--字体图标 fa fa-*-->
  <link rel="stylesheet" href="fonts/font-awesome.css" />
  <!--字体图标 iconfont icon-*-->
  <link rel="stylesheet" href="fonts/iconfont.css" />
  <!--bootstrap-->
  <link rel="stylesheet" href="js/bootstrap/bootstrap.css" />
  <!--bootstrap过滤样式-->
  <link rel="stylesheet" href="js/bootstrap/bootstrapfiller.css" />
  <!--通用动画样式-->
  <link rel="stylesheet" href="css/animate.css" />
  <!--基础样式文件-->
  <link rel="stylesheet" href="css/common.css" />
  <script type="text/javascript" src="js/jquery.js"></script>
  <script>
    $(() => {
      let color = localStorage.xa_color;
      $(".js_skin").addClass(color);
    });
  </script>
  <style>
    /*white
        主色调:#fff
        深色调:#003180
        次色调:#03a9f4
        主色Text:#9e9e9e
        次要Text:#03a9f4
      * */
    .index_skin.white {
      background: #f2f7fc;
    }

    .index_skin.white .index_menus .user_info {
      background: #fff;
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }

    .index_skin.white .index_menus .user_info .icon-logo {
      color: #003180;
    }

    .index_skin.white .index_menus {
      background: rgb(255, 255, 255);
      box-shadow: 0px 6px 15px 0px rgba(226, 226, 226, 0.5294117647058824);
    }

    .index_skin.white .index_menus .user_info .userfont {
      color: #1e92f5;
      background: linear-gradient(to right, #001458, #3f68ff);
      -webkit-background-clip: text;
      color: transparent;
    }

    .index_skin.white .index_menus .user_info .userfont .caret {
      color: #3f68ff;
    }

    .index_skin.white .text-muted {
      color: #9e9e9e;
    }

    .index_skin.white .index_menus .menu_items a.active {
      border-color: #03a9f4;
      background: #f2f7fc;
      color: #03a9f4;
    }

    .index_skin.white .index_menus .menu_items a:hover {
      background: #f2f7fc;
      color: #03a9f4;
    }

    .index_skin.white .index_menus .menu_items ul li a {
      color: #9e9e9e;
    }

    /*nav start*/
    .index_skin.white .index_content .nav {}

    .index_skin.white .index_content .nav {
      background: #FAFAFA;
      border-bottom: solid 2px #3285FF;
    }

    .index_skin.white .index_content .nav .nav_tabbox .nav_tabs .nav_item {
      color: #999;
      display: inline-block;
      float: left;
      font-size: 1.3rem;
      height: 38px;
      padding: 0 15px;
      border-right: 1px solid #eee;
      transition: color, background-color .75s;
    }

    .index_skin.white .index_content .nav .nav_tabbox .nav_tabs>:first-child {
      background: #F2F2F2;
      color: #777;
    }

    .index_skin.white .index_content .nav .nav_tabbox .nav_tabs .nav_item:hover {
      display: block;
      background: #F2F2F2;
      color: #777;
    }

    .index_skin.white .index_content .nav .nav_tabbox .nav_tabs .nav_item.action {
      background-color: #3285FF;
      color: #C4D9FD;
    }

    .index_skin.white .index_content .nav .nav_tabbox .nav_tabs .nav_item.action:hover {
      display: block;
      color: #fff;
    }

    .index_skin.white .index_content .nav>a {
      background: #fff;
      border-right: solid 1px #eee;
      color: #999
    }

    .index_skin.white .index_content .nav>a:hover {
      background: #F2F2F2;
      color: #777;
    }

    /*end nav*/
    /*bulue
        主色调:#0072ff , #00c6ff
        深色调:#0072ff
        次色调:#03a9f4
        主色Text:#fff
        次要Text:#757575
        不可用Text:##BDBDBD
      * */
    .index_skin.blue {
      background: #f2f7fc;
    }

    .index_skin.blue .index_menus .user_info {
      background: #0072ff;
    }

    .index_skin.blue .index_menus .user_info .icon-logo {
      color: #fff;
    }

    .index_skin.blue .index_menus {
      background: rgb(255, 255, 255);
      box-shadow: 0px 6px 15px 0px rgba(226, 226, 226, 0.5294117647058824);
    }

    .index_skin.blue .index_menus .user_info .userfont {
      color: #fff;
    }

    .index_skin.blue .text-muted {
      color: #fff;
    }

    .index_skin.blue .index_menus .menu_items a.active {
      border-color: #f2f7fc;
      background: #f2f7fc;
      color: #03a9f4;
    }

    .index_skin.blue .index_menus .menu_items a:hover {
      background: #f2f7fc;
      color: #03a9f4;
    }

    .index_skin.blue .index_menus .menu_items ul li a {
      color: #fff;
    }

    .index_skin.blue .index_menus .index_menus_box {
      background: linear-gradient(#0072ff, #00c6ff)
    }

    ;

    /*nav start*/
    .index_skin.blue .index_content .nav {}

    .index_skin.blue .index_content .nav {
      background: #FAFAFA;
      border-bottom: solid 2px #3285FF;
    }

    .index_skin.blue .index_content .nav .nav_tabbox .nav_tabs .nav_item {
      color: #999;
      display: inline-block;
      float: left;
      font-size: 1.3rem;
      height: 38px;
      padding: 0 15px;
      border-right: 1px solid #eee;
      transition: color, background-color .75s;
    }

    .index_skin.blue .index_content .nav .nav_tabbox .nav_tabs>:first-child {
      background: #F2F2F2;
      color: #777;
    }

    .index_skin.blue .index_content .nav .nav_tabbox .nav_tabs .nav_item:hover {
      display: block;
      background: #F2F2F2;
      color: #777;
    }

    .index_skin.blue .index_content .nav .nav_tabbox .nav_tabs .nav_item.action {
      background-color: #3285FF;
      color: #C4D9FD;
    }

    .index_skin.blue .index_content .nav .nav_tabbox .nav_tabs .nav_item.action:hover {
      display: block;
      color: #fff;
    }

    .index_skin.blue .index_content .nav>a {
      background: #fff;
      border-right: solid 1px #eee;
      color: #999
    }

    .index_skin.blue .index_content .nav>a:hover {
      background: #F2F2F2;
      color: #777;
    }

    /*end nav*/
    /*.index_menus start*/
    .index_menus {
      position: fixed;
      height: 100%;
      width: 220px;
      background: rgb(47, 64, 80);
      z-index: 1;
      white-space: nowrap;
    }

    .index_menus .user_info {
      height: 200px;
      padding: 50px;
      width: 100%;
      background: #263949;
      color: #fff;
    }

    .index_menus .user_info .logo {
      width: 100px;
      height: 60px;
      text-align: center;
      line-height: 60px;
      font-size: 28px;
      color: #FC0;
      text-shadow: 1px 1px #000, 2px 2px #000;
      letter-spacing: 5px;
    }

    .index_menus .user_info .userfont {
      color: #fff;
    }

    .index_menus .index_menus_box {
      height: calc(100% - 200px);
      width: 220px;
      overflow: hidden;
    }

    .index_menus .menu_items {
      width: 240px;
      height: 100%;
      overflow: auto;
    }

    .index_menus .menu_items ul li {
      font-size: 0;
    }

    .index_menus .menu_items ul li a {
      border-left: 4px solid transparent;
      transition: border-color 0.75s;
      color: #ccc;
      display: inline-block;
      width: 220px;
      height: 30px;
      line-height: 30px;
      text-align: center;
      transition: all .2s linear;
      padding: 0 10px;
      font-size: 12px;
      position: relative;
    }

    .index_menus .menu_items ul li a.level1 {
      padding-left: 15px;
    }

    .index_menus .menu_items ul li a.level2 {
      padding-left: 30px;
    }

    .index_menus .menu_items ul li a.level3 {
      padding-left: 45px;
    }

    .index_menus .menu_items ul li a.level4 {
      padding-left: 60px;
    }

    .index_menus .menu_items ul li a.level5 {
      padding-left: 75px;
    }

    .index_menus .menu_items a:hover {
      color: #fff;
      background-color: #293846;
    }

    .index_menus .menu_items a.active {
      border-color: #03a9f4;
      background: #293846;
      color: #fff;
    }

    .index_menus .menu_items a>span {
      line-height: 30px;
      display: inline-block;
      float: left;
      width: 100%;
      height: 30px;
      padding-right: 20px;
      text-align: left;
      position: relative;
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
      word-break: break-all;
      word-wrap: break-word;
    }

    .index_menus .menu_items a>span i {
      margin-right: 8px;
      line-height: 30px;
    }

    .index_menus .menu_items a>i {
      width: 30px;
      position: absolute;
      right: 10px;
      height: 30px;
      line-height: 30px;
      line-height: 28px;
      text-align: center;
      font-size: 16px;
      transition: all .2s linear;
    }

    .index_menus .menu_items a>i.closed {
      transform: rotate(90deg);
    }

    .index_menus .menu_items>ul>li>a {
      height: 45px;
      line-height: 45px;
    }

    .index_menus .menu_items>ul>li>a>span {
      height: 45px;
      line-height: 45px;
    }

    .index_menus .menu_items>ul>li>a i {
      height: 45px;
      line-height: 45px;
    }

    /*end index_menus*/
    /*index_content start*/
    .index_content {
      height: 100%;
      width: 100%;
      position: fixed;
      top: 0;
      padding-left: 220px;
    }

    /*nav start*/
    .index_content .nav {
      height: 40px;
      background: #FAFAFA;
      position: relative;
      border-bottom: solid 2px #2f4050;
    }

    .index_content .nav .nav_tabbox {
      position: relative;
      width: 10000px;
      left: 40px;
    }

    .index_content .nav .nav_tabbox .nav_tabs {
      position: absolute;
      left: 0;
      top: 0;
      overflow: hidden;
      transition: left .75s;
      line-height: 38px;
    }

    .index_content .nav .nav_tabbox .nav_tabs .nav_item {
      color: #999;
      display: inline-block;
      float: left;
      font-size: 1.3rem;
      height: 38px;
      padding: 0 15px;
      border-right: 1px solid #eee;
      transition: color, background-color .75s;
    }

    .index_content .nav .nav_tabbox .nav_tabs>:first-child {
      background: #F2F2F2;
      color: #777;
    }

    .index_content .nav .nav_tabbox .nav_tabs .nav_item:hover {
      display: block;
      background: #F2F2F2;
      color: #777;
    }

    .index_content .nav .nav_tabbox .nav_tabs .nav_item.action {
      background-color: #293846;
      color: #a7b1c2;
    }

    .index_content .nav .nav_tabbox .nav_tabs .nav_item.action:hover {
      display: block;
      color: #fff;
    }

    .index_content .nav .nav_tabbox .nav_tabs .nav_item .fa {
      padding: 0 3px;
      transition: transform .75s;
      line-height: 38px;
    }

    .index_content .nav .nav_tabbox .nav_tabs .nav_item .fa:hover {
      transform: rotate(180deg);
    }

    .index_content .nav>a {
      display: inline-block;
      height: 100%;
      width: 40px;
      line-height: 38px;
      text-align: center;
      background: #fff;
      border: 0;
      position: absolute;
      border-right: solid 1px #eee;
      color: #999
    }

    .index_content .nav>a:hover {
      background: #F2F2F2;
      color: #777;
    }

    .index_content .nav .nav_left {
      left: 0;
      top: 0;
      z-index: 2;
    }

    .index_content .nav .nav_right {
      right: 40px;
      top: 0;
      border-left: solid 1px #eee;
    }

    .index_content .nav .nav_flush {
      right: 0px;
      top: 0;
    }

    /*end nav*/
    .index_content .index_c_box {
      top: 60px;
      height: calc(100% - 40px);
      width: 100%;
      overflow: auto;
      font-size: 0;
    }

    .index_content .index_c_box iframe {
      border: none;
      width: 100%;
      height: 100%;
    }

    /*end index_content*/
  </style>
</head>

<body class="bg-gray index_skin js_skin">
  <div class="index_menus">
    <div class="user_info text-center ">
      <a href="jascript:;">
        <div class="logo a_pan_shine">XA</div>
      </a>
      <div class="dropdown">
        <a data-toggle="dropdown" class="dropdown-toggle" href="javascript:;">
          <span class="block m-t-xs"><strong class="fw700 userfont">欢迎浏览 <b class="caret"></b></strong>
        </a>
        <ul class="dropdown-menu dropdown-menu-right animated fadeInRight m-t-xs">
          <li><a href="jascript:;" class="js_changeStyle">看腻了</a></li>
        </ul>
      </div>
    </div>
    <div class="index_menus_box">
      <div class="js_index_menus menu_items">
      </div>
    </div>
  </div>
  <div class="index_content">
    <div class="nav">
      <a href="javascript:;" class="nav_left" id="js_navl" title="左滚动">
        <i class="fa fa-arrow-left"></i>
      </a>
      <div class="nav_tabbox">
        <div class="nav_tabs" id="js_nav">
        </div>
      </div>
      <a href="javascript:;" class="nav_right" id="js_navr" title="右滚动">
        <i class="fa fa-arrow-right"></i>
      </a>
      <a href="javascript:;" class="nav_flush" id="js_reflush" title="刷新页面">
        <i class="fa fa-refresh"></i>
      </a>
    </div>
    <ul class="dropdown-menu" id="js_contmenu">
      <li>
        <a class="js_remove" href="#"> 关闭当前页 </a>
      </li>
      <li>
        <a class="js_other" href="#"> 关闭其他页 </a>
      </li>
      <li>
        <a class="js_moveright" href="#"> 关闭右侧页 </a>
      </li>
    </ul>
    <div class="index_c_box animated fadeInRight js_index_content">
      <!-- <iframe src="page/test.html"></iframe> -->
    </div>
  </div>
  <!--jQuery-->
  <script type="text/javascript" src="js/bootstrap/bootstrap.js"></script>
  <script type="text/javascript" src="js/rjtx.js"></script>
  <script type="text/javascript" src="js/pinyin.js"></script>
  <script type="text/javascript" src="js/index.js"></script>
  <script type="text/javascript" src="js/util.js"></script>
  <script type="module">
    import menuData from "./js/data.js"

    var index = {
      callback: null,
      home: "",
      menus: [],
      omenus: [],
      init: async function () {
        await this.initmenus();
        //路由注册
        this.hashUrl()
        //菜单点击
        this.menusClick()
        //切换风格
        this.changeStyle();
      },
      initmenus() {
        let $this = this;
        let data = menuData;
        
        data = data[0].menus;
        $this.omenus = $.extend(true, [], data);
        data = simpleToPS(data);
        //排序
        $this.menus = sortAll(data)

        function sortAll(data) {
          data = data.sort((a, b) => {
            if (a.order === 0 || a.order) {
              return a.order * 1 - b.order * 1;
            } else {
              return 0;
            }
          })
          data.map((item, index) => {
            if (item.children.length > 0) {
              item.children = sortAll(item.children);
            }
          })

          return data;
        }
        //获取html
        let html = $this.getHTML(data);
        $(".js_index_menus").html(html);

      },
      getHTML(data) {
        let html = "";
        data.map(v => {
          let temp = "";
          if (v.children.length > 0) {
            temp = this.getHTML(v.children);
            html +=
              `<li>
                <a href="javascript:;" class="level${v.level} js_index_pItem">
                    <span>${v.icon ? `<i class="${v.icon} fa-fw"></i>` : ""}${v.name}</span>
                    <i class="fa fa-angle-down js_index_caret fa-fw"></i>
                </a>
                ${temp}
              </li>`
          } else {
            html +=
              `<li>
              <a href="javascript:;" class="level${v.level} js_index_sItem" data-src="${v.url}">
                  <span>${v.icon ? `<i class="${v.icon} fa-fw"></i>` : ""}${v.name}</span>
              </a>
            </li>`
          }
        });
        html = `<ul>${html}</ul>`
        return html;
      },
      hashUrl() {
        let $this = this;
        let run = function () {
          let url = window.location.hash ? window.location.hash.slice(1) + ".html" : $this.home;
          let tabOpts = { name: "", src: "", active: true, showclosebtn: true }
          //默认页面设置
          if (url == "/.html" || url == "") {
            url = $this.home || $this.findurl($this.menus);
            tabOpts.showclosebtn = false;
          }
          if ($(".nav_item").length == 0) {
            tabOpts.showclosebtn = false;
          }
          $this.cssDeal(url);
          $this.addIframe(url);
          let name = null;
          $this.omenus.forEach((v, i) => {
            if (v.url == url) {
              name = v.name;
              return false;
            }
          });
          tabOpts.name = name;
          tabOpts.src = url;
          tabs.addtab(tabOpts);
        }
        run()
        window.onpopstate = run
      },
      addIframe(url) {
        let urls = Array.from($(".index_c_box iframe")).map(v => $(v).data("src"));
        if (!urls.includes(url)) {
          $(".index_c_box").append(`<iframe src="${url}" data-src="${url}"></iframe>`);
        }
        $(".index_c_box iframe").hide();
        $(`.index_c_box iframe[data-src='${url}']`).show();
      },
      jumpMenu(url, callback) {
        let hash = "";
        if (url) {
          if (url.lastIndexOf(".") != -1) {
            url = url.slice(0, url.lastIndexOf("."));
            hash = url;
          }
        }
        this.callback = callback || this.callback;
        window.location.hash = "#" + hash;
      },
      cssDeal(url) {
        $(".js_index_sItem").each(function (index, dom) {
          if ($(dom).data("src") == url) {
            //css
            $(".js_index_sItem").removeClass("active")
            $(dom).addClass("active");
            //滚动到视口内
            //dom.scrollIntoView(false);
            //让他的每个父都是打开的.closed
            $(dom).parents("li").find(">.js_index_pItem").find(".js_index_caret").each(function (index, dom) {
              if ($(dom).hasClass("closed")) {
                $(dom).trigger("click");
              }
            });
            return false;
          }
        });
      },
      menusClick() {
        let $this = this;
        //子点击
        $(".js_index_menus").on("click", ".js_index_sItem", function (e, fn) {
          let url = $(this).data("src") || "doing.html";
          $this.jumpMenu(url);
        });

        //子中的父点击
        $(".js_index_menus").on("click", ".js_index_pItem", function (e, fn) {
          e.stopPropagation()
          //切换和收起
          if ($(this).find(".js_index_caret").hasClass("closed")) {
            $(this).find(".js_index_caret").removeClass("closed");
            $(this).closest("li").find(">ul").slideDown("fast");
          } else {
            $(this).find(".js_index_caret").addClass("closed");
            $(this).closest("li").find(">ul").slideUp("fast");
          }
        });
      },
      //找到第一个url
      findurl(data) {
        for (let i = 0, len = data.length; i < len; i++) {
          let v = data[i];
          if (v.children.length > 0) {
            return this.findurl(v.children);
          }
          if (v.url && v.children.length == 0) {
            return v.url;
          }
        }
      },
      changeStyle() {
        //color
        let colors = ["nomal", "blue", "white"];
        $(".js_changeStyle").click(function () {
          let color = localStorage.xa_color || "nomal";
          let index = colors.indexOf(color) + 1;
          let ranIndex = Math.ceil(Math.random() * 3);
          while (index == ranIndex) {
            ranIndex = Math.ceil(Math.random() * 3)
          }
          localStorage.xa_color = colors[ranIndex - 1];
          $(".js_skin").removeClass("nomal blue white").addClass(colors[ranIndex - 1]);
        });
      }
    }
    index.init();
  </script>
</body>

</html>